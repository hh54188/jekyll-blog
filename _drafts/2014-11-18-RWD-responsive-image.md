# 移动开发的那些事（下）：响应式图片设计

如果你还没有了解过有关于响应式设计的一些概念，可以再开始阅读这篇文章之前阅读这一系列的上篇开始：
[浅谈移动Web开发（上）：深入概念](http://www.infoq.com/cn/articles/development-of-the-mobile-web-deep-concept)。上篇介绍了一些你必须掌握的移动端开发中要用到的概念，并且同其他概念做了一些区分。可以说上一篇是为这一篇服务的。在这一篇中，我们就需要运用到上一篇中了解的那些概念。

你可能会有疑问，为什么下篇说的是响应式图片的设计，为什么不是响应式设计。一方面因为响应式设计已经被说的太多了，有太多的文章在谈；另一方面，如果你对响应式这一块有关注的话，响应式图片与响应式设计并非包含关系，从某种意义上来说，响应式图片已经可以成为与响应式设计平行的一个技术分支。所以我们可以拿出来着重的说。

在构思这篇文章的时候，我的想法是按部就班的把响应式图片的技术一一做一个介绍。但是在学习中逐渐发现，响应式图片技术产生的原因，或者它所面临的困境更加的有趣或者吊诡。或者说，如果我能把所有的这些前因后果做一个介绍，或许能帮助大家更好的理解掌握技术，更好的集思广义。

当然，正如文章的标题所说，文字的容量总是有限的，所以做到的只能是浅谈。所以这篇文章里更多描述的是想法：问题是如何产生的，现有解决方案的不足，新的解决方案的思路，新的解决办法的不足。

## User Cases

首先我们要了解清楚在什么情况下需要用到响应式图片。W3C的RICG(Responsive Images Community Group)小组给出了如下的[四种用户用例](http://usecases.responsiveimages.org#h2_use-cases)，

### 基于分辨率选择：

![resolution_selection](./images/resolution_selection.jpg)

这个是最基本的需求，也就根据网页所处设备分辨率的不同选择图片。你可能觉得说分辨率变了，图片使用同一张用css控制宽高等比压缩就好了。其实不仅仅是根据分辨率不同来选择图片，比如说较小分辨率可能就意味着加载网页的这台设备性能有限，很大概率下是手机的话就意味着带宽有限。如果能根据分辨率加载图片，我们就能提供给适合该设备的图片。节省带宽与时间。

### 基于DevicePixelRatio

![dpr_selection](./images/dpr_selection.jpg)

在上一篇中我们从PPI引出了DevicePixelRatio（以下简称DPR）。 我们知道高像素密度下设备的物理像素很小，而大部分的优化方案会造成图片素材的模糊。因此我们需要为高DPR的设备特意准备更高清的素材。

### 基于viewport

![viewport_selection](./images/viewport_selection.jpg)

或许你的第一反应是基于viewport貌似和基于分辨率非常的像？某种意义上是的。但就像在上一篇所说的那样，移动设备的上的viewport通常与分辨率并非一一对应的关系。比如在iPhone4上，默认的viewport是980px，但是你也可以指定为与visual viewport大小相等。可以这么理解，基于viewport比基于屏幕分辨率更加精确。

### Art direction

我不知道应该如何翻译这个词组比较好，我们姑且采用百度百科里的翻译，译为“美术设计”。

它描述的是这样一种情况，假设我们基于分辨率设计响应式图片。那么在高分辨率和低分辨率下图片素材对比如图：

高分辨率：

![obama-500](./images/obama-500.jpg)

低分辨率：

![obama-100](./images/obama-100.jpg)

我们的任务就完成了，虽然做到了响应式，但是第二张图中的任务几乎是不可见的，我们压根无法分辨出其中的奥巴马。
所以更适合的图片应该是这样：

![obama-100-art](./images/obama-100-art.jpg)

虽然图片大小仍然和低分辨下保持一致，但我们对图片进行了剪裁，略去了可以被忽视的背景图片。

在这之前的几种场景只需要用户上传一张尺寸足够大的图片，然后仅仅缩放图片去适应就好了。而这一种情况下，图片不仅仅是被缩放，还需要被重新设计和剪裁。所以在后面的部分你会看到它使用的技术是和前三者不一样的。

![art_direction](./images/art_direction.jpg)

## 按照响应式的设计如何？

你的第一个疑问是，为什么响应式图片不就简简单单跟随页面响应式设计的断点(break points)就好？

### 死循环

```
<img src="sample.png" srcset="cat_750px.jpg 1.5x, cat_1000px.jpg 2x">
<img src="sample.png" srcset="cat_750px.jpg 700w, cat_1000px.jpg 1000w">
```
【上面的700w是min-width还是max-width?】
